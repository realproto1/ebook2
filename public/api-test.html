<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API 테스트 페이지</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">API 연결 테스트</h1>
        
        <div id="status" class="mb-6 p-4 rounded-lg">
            <p class="text-gray-600">테스트 버튼을 클릭하세요...</p>
        </div>
        
        <button 
            onclick="testAPI()"
            class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-semibold"
        >
            API 연결 테스트
        </button>
        
        <div id="details" class="mt-6 hidden">
            <h2 class="text-xl font-bold text-gray-800 mb-3">상세 정보:</h2>
            <pre id="response" class="bg-gray-100 p-4 rounded-lg overflow-auto text-sm"></pre>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script>
        async function testAPI() {
            const statusDiv = document.getElementById('status');
            const detailsDiv = document.getElementById('details');
            const responseDiv = document.getElementById('response');
            
            statusDiv.innerHTML = '<p class="text-blue-600">테스트 중...</p>';
            detailsDiv.classList.add('hidden');
            
            try {
                const response = await axios.post('/api/generate-storybook', {
                    title: 'API 테스트',
                    targetAge: '5-7',
                    artStyle: 'Modern Illustration'
                });
                
                statusDiv.innerHTML = '<p class="text-green-600 font-bold">✅ 성공! API가 정상 작동합니다.</p>';
                statusDiv.className = 'mb-6 p-4 rounded-lg bg-green-50';
                
                detailsDiv.classList.remove('hidden');
                responseDiv.textContent = JSON.stringify(response.data, null, 2);
            } catch (error) {
                console.error('API Error:', error);
                
                const errorMsg = error.response?.data?.error || error.message || '알 수 없는 오류';
                const statusCode = error.response?.status || '없음';
                
                statusDiv.innerHTML = `
                    <p class="text-red-600 font-bold">❌ 실패: API 오류</p>
                    <p class="text-sm text-gray-600 mt-2">상태 코드: ${statusCode}</p>
                    <p class="text-sm text-gray-600 mt-1">오류 메시지: ${errorMsg}</p>
                `;
                statusDiv.className = 'mb-6 p-4 rounded-lg bg-red-50';
                
                detailsDiv.classList.remove('hidden');
                responseDiv.textContent = JSON.stringify({
                    status: statusCode,
                    error: errorMsg,
                    fullError: error.response?.data || error.message
                }, null, 2);
            }
        }
    </script>
</body>
</html>
